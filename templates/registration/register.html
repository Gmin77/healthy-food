{% extends 'base.html' %}

{% block extra-style %}
<style>
    /* 입력 필드의 넓이 조절 */
    .form-control {
        width: 100%; /* 입력 필드 전체 넓이를 사용하도록 설정 */
    }

    /* 화면 중앙 정렬 */
    .center {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 80vh; /* 화면 전체 높이를 차지하도록 설정 (선택 사항) */
    }

    /* 입력 필드와 레이블을 수직으로 중앙 정렬 */
    .form-row {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    /* 입력 필드 컨테이너의 넓이 설정 */
    .form-container {
        max-width: 800px; /* 입력 필드 컨테이너의 최대 넓이를 지정 (선택 사항) */
    }

    .title{
        text-align :center; 

    }

    .center{
        margin-top : 120px;
    }
</style>
{% endblock %}


{% block content %}
<div class="container mt-5">
    <div class="title">
        <h1>회원가입</h1>
        <p>아래의 정보를 입력해주세요.</p>
    </div>
    <div class="center">
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ user_form.as_p }}
              
            {{ profile_form.as_p }}
            <button type="submit" class="btn btn-primary">가입하기</button>
        </form>
    </div>
</div>
<script>
    $(document).ready(function() {
        $('#id_nickname').change(function() {
            var nickname = $(this).val();
            checkDuplicate('nickname', nickname);
        });
    
        $('#id_email').change(function() {
            var email = $(this).val();
            checkDuplicate('email', email);
        });
    
        function checkDuplicate(fieldType, fieldValue) {
            $.ajax({
                url: '/check_duplicate/',  // 중복 확인을 처리할 Django 뷰의 URL
                method: 'GET',
                data: {
                    'field_type': fieldType,
                    'field_value': fieldValue
                },
                success: function(response) {
                    if (response.is_taken) {
                        alert('이미 사용 중인 ' + fieldType + '입니다.');
                        // 필요에 따라 사용자에게 메시지를 보여줄 수 있습니다.
                    }
                },
                error: function(error) {
                    console.log('Error:', error);
                }
            });
        }
    });
    </script>
{% endblock %}